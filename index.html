<!DOCTYPE html>
<html>
<head>
	<title>Добро пожаловать | Вконтаке</title>
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
Сайт, на котором можно найти инфу по PIC:
https://narodstream.ru/programmirovanie-mk-pic/
http://www.gaw.ru/html.cgi/txt/doc/micros/pic/asm14/btfss.htm

Контрольные вопросы.

1. Блок-схема микропроцессора.



2. Блок-схема микроконтроллера.


3. Блок-схема сигнального процессора. Особенности.

Сигнальные процессор (PSP) - АЛУ работает быстрее, набор прерываний более бедный, некоторые ячейки памяти имеют бОльшую разрядность.
An = (Bn+Cn)+An-1 (могу предположить, что это считается амплитуда из кос. и син. составляющих)
наличие специфических команд
У сигнального процессора набор прерываний меньше (у него 1-2 такта)
некоторые ячейки памяти имеют бОльшую разрядность

4. Типы регистров памяти данных. Особенности использования.

Регистры специального назначения (SFR, служебные) – это регистры, которые предназначены для хранения строго отведенных величин и имеют определённые имена. (отражают результат работы программы, конфигурируют работу дополнительных модулей)
Регистры общего назначения (GPR) – это ячейки памяти, которые имеют только адреса и предназначены они для хранения любых данных.


5. Назначение битов служебного регистра STATUS микроконтроллера PIC18F252.

С - признак переполнения
DC - признак переполнения в доп. коде (знак числа)
Z - признак нулевого результата
OV - дополняет DC 
N - отрицательный результат в доп. коде

6. Типы команд микроконтроллера PIC18F252. Особенные признаки в составе синтаксиса команд.

команды делятся на:
байт-ориентированные
бит-ориентированные
операции с константами
управляющие команды
операции с содержимым памяти данных и памяти программ

особенности синтаксиса:
f - название/адрес байта в памяти данных
b - номер/название бита в пределах байта
k - константа, конкретное число, с которым мы хотим работать
d - место хранения результата
a - тип используемой памяти данных
7. Описать алгоритм работы команды ADDWF с использованием дополнительных признаков.

ADDWF (f,d,a) - Содержимое регистра W добавляется к содержимому регистра f (W+F). Если d = 0, результат сохраняется в регистре W. Если d = 1, результат сохраняется в том же регистре f.

8. Описать алгоритм работы команды ANDWF с использованием дополнительных признаков.

ANDWF (f,d,a) - Содержимое регистра W логически умножается на содержимое регистра f (W and f). Если d = 0, результат сохраняется в регистре W. Если d = 1, результат сохраняется в том же регистре f.

9. Описать алгоритм работы команды DECFSZ с использованием дополнительных признаков.

DECFSZ (f,d,a) - декремент f, пропустить команду, если 0;

Регистр f уменьшается на 1. Если d = 0, результат сохраняется в регистре W. Если d = 1, результат сохраняется в том же регистре f. Если результат не равен 0, выполняется следующая команда. Если результат равен 0, следующая команда, считанная в текущем командном цикле, игнорируется, и вместо нее в следующем цикле выполняется NOP, в результате команда выполняется за два цикла.

10. Описать алгоритм работы команды INCFSZ с использованием дополнительных признаков.

INCFSZ (f,d,a) - инкремент f, пропустить команду, если 0; 

Регистр f увеличивается на 1. Если d = 0, результат сохраняется в регистре W. Если d = 1, результат сохраняется в том же регистре f. Если результат не равен 0, выполняется следующая команда. Если результат равен 0, следующая команда, считанная в текущем командном цикле, игнорируется, и вместо нее в следующем цикле выполняется NOP, в результате команда выполняется за два цикла.

11. Описать алгоритм работы команды MULWF с использованием дополнительных признаков.

MULWF(дополнительная команда, f,d,a) - умножение W и f => PRODH:PRODL (результат)

Результат умножения W и f записывается в пару регистров PRODH:PRODL. PRODH содержит старший бит, W, f и флаги состояний остаются неизменными при выполнении операции. PRODH -> РЕЗУЛЬТАТ, PRODL -> Регистры спец функций


12. Привести синтаксис команды сдвиг влево через перенос и без использования переноса. Продемонстрировать процесс выполнения вариантов команд.
RLCF - циклический сдвиг влево в PIC.
Содержимое регистра f сдвигается на 1 бит влево через бит переноса С. Если d = 0, результат сохраняется в регистре W. Если d = 1, результат сохраняется в том же регистре f.
RLCF REG1,0
Перед выполнением команды: REG1 = 11100110, C = 0
После выполнения команды:	
REG1 = 11100110, C = 1, W = 11001101

RLNCF - циклический сдвиг влево БЕЗ участия переноса в PIC18. Бит переноса вообще никак не участвует в выполнении этой команды. Он не изменяется.

13. Привести синтаксис команды сдвиг вправо через перенос и без использования переноса.
Продемонстрировать процесс выполнения вариантов команд.

RRCF - циклический сдвиг вправо в PIC.
Содержимое регистра f сдвигается на 1 бит вправо через бит переноса С. Если d = 0, результат сохраняется в регистре W. Если d = 1, результат сохраняется в том же регистре f.
RRCF REG1,0
Перед выполнением команды: REG1 = 11100110, С = 0
После выполнения команды: REG1 = 11100110, C = 0, W = 01110011

RRNCF - циклический сдвиг вправо БЕЗ участия переноса в PIC18. Бит переноса вообще никак не участвует в выполнении этой команды. Он не изменяется.


14. Описать алгоритм работы команды SWAPF с использованием дополнительных признаков.

SWAPF (f,d,a) - обмен тетрад в f; 

Содержимое старшей и младшей тетрад регистра f обмениваются. Если d = 0, результат сохраняется в регистре W. Если d = 1, результат сохраняется в том же регистре f.

10000001 (1000 + 0001) -> 00011000 (0001 + 1000)

15. Описать алгоритм работы команды BTFSC с использованием дополнительных признаков.

BTFSC (f,b,a) - пропустить команду, если бит (f(b)) равен нулю.

Если бит b регистра f равен 1, выполняется следующая команда. Если бит b регистра f равен 0, следующая команда, считанная в текущем командном цикле, игнорируется, и вместо нее в следующем цикле выполняется NOP, в результате команда выполняется за два цикла.

16. Описать алгоритм работы команды BTFSS с использованием дополнительных признаков.

BTFSS (f,b,a) - пропустить команду, если бит (f(b)) равен единице.

Если бит b регистра f равен 0, выполняется следующая команда. Если бит b регистра f равен 1, следующая команда, считанная в текущем командном цикле, игнорируется, и вместо нее в следующем цикле выполняется NOP, в результате команда выполняется за два цикла.

17. Описать алгоритм работы команды CLRWDT. Необходимость использования.

CLRWDT - сброс сторожевого таймера WDT.

Команда сбрасывает сторожевой таймер WDT и предварительный делитель. В регистре состояния устанавливаются биты TO и PD. 

Необходимость использования - помехи, возникающие при работе.

18. Описать возможный алгоритм реализации деления в системе команд микроконтроллера PIC18F252
Многократным вычитанием при отсутствии специальной команды деления.

проверка делителя на ноль, т.к. делить на 0 нельзя
Сдвигаем делитель влево настолько, насколько это потребуется (до самого старшего разряда). Нужно считать сколько раз мы сдвинули влево делитель - это счетчик вычитаний. Нужно прибавить к счетчику единицу, потому что нужно как минимум 1 раз вычитать
Вычитаем сдвинутый делитель из делимого. Если разность больше нуля, то в ЧАСТНОЕ ВДВИГАЕМ СПРАВА ЕДИНИЦУ и делимое теперь и будет этой разностью. Если разность меньше нуля - вдвигаем справа ноль и делимое оставляем без изменений.
Сдвигаем делитель на один разряд вправо.
Проверка завершения. Уменьшаем счетчик вычитаний, полученный на шаге №2 на единицу. Если он равен нулю, то деление закончено и частное и есть результат, иначе возвращаемся к шагу 3

То есть надо использовать: инкремент, декремент, бесконечный цикл, условия, сдвиги влево и вправо, вычитания.

19. Особенности чтения и записи данных в память программ микроконтроллера PIC18F252.

Память программ PIC18 организована в виде 16-битных слов, однако может адресоваться побайтно. Это означает, что старшее и младшее слово инструкции могут быть доступны при использовании косвенной адресации. Память программ выровнена по младшему байту слова, при линейном выполнении кода программный счетчик всегда увеличивается на 2.
Микроконтроллеры PIC18 имеют побайтный доступ к памяти программ с помощью табличных инструкций чтения.

(из лекции)
Чтение реализуется посредством 4-ех служебных регистров:
TBLPTRL - младший
TBLPTRH - средний
TBLPTRU - старший
TABLAT - Записать и прочитать/дать команду на чтение. Именно сюда помещается информация при чтении памяти программы.
Возможно это просто дополнительные регистры для чтения, которые есть в разных версиях компиляторов:
TBLRD*  -чтение содержимого памяти программы по адресу указанному здесь
TBLRD*+ -производится чтение из ячейки, адрес которой можно регулировать TBLPTRL, TBLPTRH, TBLPTRU
TBLRD*- -(на записал определение, но у меня написано, что это тоже самое, что и первое)
TBLRD+* -(не записал определение)

Регистры для записи:
TBLWR*, TBLWR*+, TBLWR*-, TBLWR+*

20. Привести перечень операторов, используемых для конфигурации памяти данных и памяти программ с примерами.
buffer egu 0x01	movf buffer, 0 (типо очищаем буфер, задаем размерность, уст. 0)
look egu 0x02		movf 0x01, 0
key egu 0x03
SFR - регистры (служебные регистры, предназначены для хранения строго опред. величин)
INTCON egu FF01
buffer egu 0x01
look egu 0x02
key egu 0x03	

21. Описать особенности формирования сигнала «Сброс» при включении питания.
нужно подать питание на первый порт (1) MCLR - вывод для организации аппаратного сброса (похож на RESET)
Можно также использовать микросхему гарантированного сброса (супервизор)

22. Описать возможные режимы работы тактового генератора.
Режимы тактового генератора:
LP
XT 
HC - 
HC+PLL
RC
RCIO
EC
ECIO

Другая классификация (из лаб):
LP - 32 кГц, маломощный кристаллический режим (Экономичный режим резонатора)
XT - Кристалл со средним коэф. усиления или Керамический резонатор. Обычный режим резонатора (от 100 кГц до 4 МГц) 
HS - Высокопроизводительный режим резонатора с частотами (4 до 20 МГц)
ECL - Внешний тактовый режим с низким энергопотреблением (ниже 500 кГц)
ECM - Режим средней мощности внешних тактовых импульсов (от 500 кГц до 8 МГц)
ECH - Режим высокой мощности внешних тактовых импульсов (выше 8 МГц)

23. Описать базовые принципы использования портов ввода/вывода для организации процесса передачи информации.
Каждый МК имеет некоторое количество линий ввода/вывода, которые объединены в многоразрядные (чаще 8-разрядные) параллельные порты ввода/вывода. 
В зависимости от реализуемых функций различают следующие типы параллельных портов:
однонаправленные порты, предназначенные только для ввода или только для вывода информации;
двунаправленные порты, направление передачи которых ( ввод или вывод ) определяется в процессе инициализации МК;
порты с альтернативной функцией (мультиплексированные порты ). Отдельные линии этих портов используются совместно со встроенными периферийными устройствами МК, такими как таймеры, АЦП, контроллеры последовательных интерфейсов;
порты с программно управляемой схемотехникой входного/выходного буфера.

Порты выполняют роль устройств временного согласования функционирования МК и объекта управления, которые в общем случае работают асинхронно. Различают три типа алгоритмов обмена информацией между МК и внешним устройством через параллельные порты ввода/вывода:

режим простого программного ввода/вывода;
режим ввода/вывода со стробированием;
режим ввода/вывода с полным набором сигналов подтверждения обмена.

24. Описать, с приведением принципиальной схемы, способа передачи сигналов управления для микроконтроллеров от человека.

Управление МК может осуществляться двумя способами:
Проводной путь. Управление исполнительными механизмами происходит через электропроводное соединение управляющих цепей и исполнительных механизмов. Включение — по нажатию кнопки на диспетчерском пункте или кнопочном пульте.
Беспроводной путь. Такой способ управления не требует проводного соединения. С передатчика или пульта дистанционного управления (ПДУ) передается сигнал, который идет на приемник.

25. Описать алгоритм передачи информации от микроконтроллера на индикацию при использовании разных источников информации.

26. Существующие способы адресации в микроконтроллерах

Способы адресации:
прямая адресация
косвенная адресация
базовая
расширенная

27. Описать принцип использования базовой косвенной адресации.
Косвенная адресация - это такая адресация, при которой в адресном поле команды указан адрес ячейки памяти или регистра, в которых хранится не сам операнд, а его адрес.
Эффективный адрес операнда может находиться в любом из регистров общего назначения, кроме esp и ebp
Пример:
      mov ax, [ecx]
      Команда перемещает в регистр ax содержимое слова по адресу из сегмента данных со смещением, хранящимся в регистре ecx.

28. Описать принцип использования расширенной косвенной адресации.

29. Прерывания. Источники прерываний. Базовые принципы создания программ с использованием сигналов прерываний.

Источники прерываний бывают:
внешние
изменение состояния RB 0-2/INT 0-2
изменение состояния PORTB(1..7)
внутренние
переполнение таймеров/счетчиков (не всех)
АЦП закончил преобразование
USART принял байт
USART закончил передачу
изменение состояния модуля последовательной передачи данных
изменение состояния ШИМ (ЦАП преобразования)
завершена запись в FLASH память
обнаружена ошибка при передаче послед. модулей
снижение напряжения питания меньше установленного порога

Принципы создания программ:
маскирование прерываний - установка бита 0, ответственного за реакцию на прерывание
создание битов отражения фактов прерываний - флаги прерываний

30. Таймер 0. Структурная схема. Особенности использования.

Таймер 0 или TMR0, как он обозначен в технической документации, — это 8-разрядный таймер/счётчик, который умеет считать только от 0 до 255, и как только достигает данной величины, происходит прерывание, если оно конечно задействовано.


В данной схеме показаны все блоки нашего таймера, а также указаны биты, которые управляют данными блоками. Биты T0CS, T0SE, PSA, PS2:PS0 расположены в регистре OPTION_REG

 



 

Данный регистр служит для управления различными параметрами и предназначен не только для таймера. Но нас пока интересуют только биты, предназначенные именно для таймера.

TOCS (TMR0 Clock Source Select) — выбор сингала для таймера: 0 — внутренний тактовый сигнал, 1 — внешний.

T0SE (TMR0 Source Edge Select) — выбор фронта приращения при внешнем тактовом сигнале: 0 — по переднему фронту, 1 — по заднему.

PSA (Prescaler Assignment) — выбор способа включения предделителя: 0 — предделитель включен через TMR0, 1 — через WDT.

PS2:PS0 (Prescaler Rate Select) — коэффициент деления предделителя



31. Таймер 1. Структурная схема. Особенности использования.
Данный таймер также считает только вперёд, причём он самостоятельно (без помощи триггеров от других модулей) не сбрасывается при сравнении его счётчика с определённой величиной, а сбрасывается только после окончания счёта, но зато есть у него немало преимуществ. Основное, я считаю, его преимущество то, что он уже 16-битный, следовательно, считает он уже не до 255, а до 65535, что более удобно и позволяет без лишних плясок с переменными выжидать большие промежутки времени до следующего прерывания.
Двухбайтовая регистровая пара TMR1H и TMR1L, состоящая из старшего и младшего байта, служит для хранения значения счётчиков.

Управляющий регистр таймера 1 — T1CON

Биты данного регистра имеют следующее назначение.

Биты T1CKPS1:T1CKPS0 (Timer1 Input Clock Prescale Select bits) — биты предделителя. Используются следующие их комбинации:

11 = 1:8 значение деления

10 = 1:4 значение деления

01 = 1:2 значение деления

00 = 1:1 значение деления

Бит T1OSCEN (Timer1 Oscillator Enable Control bit) — бит, включающий тактовый генератор.

1 — генератор включен

0 — генератор выключен (инвертор генератора отключен, чтобы исключить утечку энергии)

T1SYNC — (Timer1 External Clock Input Synchronization Control bit) — управление синхронизацией тактового сигнала

Если TMR1CS = 1:
1 — внешний тактовый сигнал не синхронизируется
0 — внешний тактовый сигнал синхронизируется
Если TMR1CS = 1, то значение игнорируется.
TMR1CS — (Timer1 Clock Source Select bit) — выбор источника тактового сигнала
1 — внешний источник с вывода RC0/T1OSO/T1CKI (активный передний фронт)
0 — тактирование от внутреннего генератора (FOSC/4)
TMR1ON — (Timer1 On bit) — бит включения таймера
1 — таймер включен
0 — таймер выключен



32. Таймер 2. Структурная схема. Особенности использования.

Таймер TIMER2 является 8-битным, но зато у него есть два делителя, что позволяет также получать немалые периоды между прерываниями. Также в одном из регистров данного таймера — PR2 — можно явным образом задавать значение периода, что также вносит огромное удобство в программирование значения точного периода, позволяя, в отличие от таймера 1 один раз при инициализации задать период, а не заносить значение в регистр счётчика при каждом прерывании.


Регистр управления таймером 2 — T2CON

Бит 7 данного регистра не используется.

Биты 6-3 — TOUTPS3:TOUTPS0 (Timer2 Output Postscale Select bits) — выбор коэффициента деления выходного делителя (постделителя). Значения данных битов следующим образом плавно управляют коэффициентом деления
0000 = 1:1
0001 = 1:2
0010 = 1:3
•••
1111 = 1:16
Следующий бит 2 — TMR2ON (Timer2 On bit) — бит включения таймера
1 — TIMER2 включен
0 — TIMER2 выключен
Биты 1-0 — T2CKPS1:T2CKPS0 (Timer2 Clock Prescale Select bits) — биты управления коэффициентом входного делителя (предделителя). Коэффициент следующим образом зависит от значений битов:
00 = Предделитель 1:1
01 = Предделитель 1:4
1x = Предделитель 1:16

33. Режимы работы модуля ШИМ (CCP). Функции, реализуемые в каждом режиме.
https://narodstream.ru/pic-urok-12-modul-ccp-rezhim-zaxvata-ik-pult-chast-1/
Хх что тут, мб с сайта можно что-то вырвать


34. Структура модуля ШИМ (CCP) в режиме «Захват».

Данные из регистров хранения результатов работы таймера переписываются в ССР1L, CCP1H
Состояние TMR1L, TMR1H сброс в 0
Формирование прерываний

35. Структура модуля ШИМ (CCP) в режиме «Сравнение».

Сброс TMR1L, TMR1H в 0
Формирование прерывания
Изменение состояния RC2(CCP1)
Возможен запуск АЦП

36. Структура модуля ШИМ (CCP) в режиме «Широтно-импульсная модуляция»



37. Особенности использования модуля ШИМ (CCP) при управлении внешними устройствами.

Из лекций:

Особенности использования ШИМ:
fслед = 1/Tслед >= 10fmax; fядра = 10 МГц, fmax = 1 МГц.
CCP1 и CCP2 могут работать независимо
Tслед одинаков для CCP1 и ССP2

Это не из лекций:
Управление электродвигателями
ШИМ применяется для управления двигателями в импульсном режиме. По характеристикам двигателя необходимо подобрать значение частоты ШИМ, чтобы обеспечить оптимальные характеристики электропривода.

Светодиоды и устройства освещения
ШИМ часто используется для изменения яркости световых приборов. Эффект мерцания может быть заметен на частотах ниже 50 Гц, поэтому на практике частота ШИМ выбирается около 100 Гц или выше.

38. Особенности использования модуля АЦП при обработке сигналов от нескольких источников.


Вроде от нескольких источников он не может, за один раз только от одного источника.

39. Формат результатов аналого-цифрового преобразования. Выбор выводов микроконтроллера для приема информации от источников аналогового сигнала.

40. Особенности формирования опорного напряжения для модуля АЦП.

41. Классификационные признаки интерфейсов последовательной передачи данных.

Классификация интерфейсов:
по направлению передачи
однонаправленные
двунаправленные
по информационной емкости
одноканальные
многоканальные
без уплотнения канала
с уплотнением канала
по способу организации процесса передачи
синхронные
асинхронные
комбинированные

42. Особенности интерфейсов с точки зрения направления передачи информации.

По направлению передачи:
однонаправленные (от источника к приемнику) - симплексные
двунаправленные - полудуплексные (в обоих направлениях в разный момент времени), дуплексные (в обоих направлениях одновременно)

43. Особенности интерфейсов с точки зрения информационной емкости.

одноканальный (от источника к приемнику отводится отдельный канал)
многоканальный: 
без уплотнения канала (от источника к приемнику отводится отдельный канал)
с уплотнением канала (по одному физическому каналу от одного источника к нескольким приемникам или один приемник может принимать от нескольких источников)
 FDMA (частотное уплотнение канала), 
TDMA (временное уплотнение канала), 
CDMA (кодовое уплотнение канала)

44. Особенности интерфейсов с точки зрения организации процесса передачи информации.

синхронные (момент передачи информации строго определен однозначно | в системе передачи данных формируется сигнал идентификации информационного бита)
асинхронные (момент выхода передатчика в режим передачи не определен | дополнительный сигнал, определяющий момент идентификации информационного бита отсутствует)
комбинированные

45. Способы обеспечения помехоустойчивости, используемые в интерфейсах последовательной передачи данных.

передача бита четности (К исходному сообщению добавляется бит, значение которого пропорционально количеству единиц (1 - четное, 0 - нечетное) Только одна ошибка!)
передача контрольной суммы: 
Арифметическая сумма (двухбайтная сумма, достаточно передать младший байт) 
Циклический избыточный код (исходное сообщение делится на определенное число (порождающий полином)) CFC - остаток от деления
использование помехоустойчивых (корректирующих) кодов (БЧХ (Бозе — Чёдхури — Хокуингхема))

Помехозащищенность - увеличение длины сообщения

46. Интерфейс I2C. Основные параметры. Особенности использования

Основные параметры:
синхронный интерфейс
скорость до 400 кБ/с
полудуплекс
число устройств до 127
помехоустойчивость ограниченная
длина линии <= 1м 

Достоинства:
2 линии передачи независимо от количества устройств
возможна передача функций MASTER
Недостатки:
ограниченное количество SLAVE из-за особенности адресов
подверженность радиочастотным помехам

47. Интерфейс SPI. Основные параметры. Особенности использования.

Основные параметры:
синхронный интерфейс
скорость от 1 Мб/с (при 1 метре)
полудуплексный
помехозащищенность ограничена
длина линии - несколько метров
количество устройств не ограничено (теоретически)

SI - вход данных slave 
SO - выход данных slave
SCK - синхросигнал
CS - выбор slave


Достоинства:
более высокая скорость
наглядность интерфейса
количество slave ограничено количеством свободных выводов
простота реализации гальваноразвязки
Недостатки:
потребность в увеличении количества выводов МК при увеличении количества устройств (slave)

48. Организация процесса передачи информации с использованием гальваноразвязки, в интерфейсе SPI.

SI - вход данных slave 
SO - выход данных slave
SCK - синхросигнал
CS - выбор slave




49. Интерфейсы USART/RS-232. Основные параметры. Отличия.
50. Особенности установки скорости передачи информации в интерфейсе USART.
51. Основной принцип использования интерфейса USART при создании системы обработки информации с несколькими микроконтроллерами.
52. Взаимное преобразование сигналов интерфейсов USART и RS-232.

</body>
</html>
